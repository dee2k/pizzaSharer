"use strict";var app=angular.module("pizzaSharerApp",["ngCookies","ngResource","ngSanitize","ngRoute","firebase"]);app.config(["$routeProvider",function(a){a.when("/",{templateUrl:"views/main.html",controller:"MainCtrl"}).when("/order",{templateUrl:"views/order.html",controller:"OrderCtrl"}).otherwise({redirectTo:"/"})}]).constant("FIREBASE_URL","https://sharpizza.firebaseio.com/"),app.controller("MainCtrl",["$scope","Auth","FIREBASE_URL","$firebaseSimpleLogin","$location",function(a,b,c,d,e){var f=new Firebase(c),g=d(f);a.loginWithFacebook=function(){b.login("facebook").then(function(){})},a.logout=function(){b.logout()},a.newOrder=function(){e.path("/order")},a.$on("$firebaseSimpleLogin:login",function(){a.username=g.user.displayName})}]),app.factory("Auth",["$firebaseSimpleLogin","FIREBASE_URL","$rootScope",function(a,b,c){var d=new Firebase(b),e=a(d),f={login:function(a){return e.$login(a)},signedIn:function(){return null!==e.user},logout:function(){e.$logout()}};return c.signedIn=function(){return f.signedIn()},c.logout=function(){return f.logout().then(function(){$location.path("/")})},c.$on("$firebaseSimpleLogin:login",function(){c.username=e.user.displayName}),f}]),app.controller("OrderCtrl",["$scope","$firebase","FIREBASE_URL","$firebaseSimpleLogin",function(a,b,c,d){a.numbersArray=[1,2,3,4,5],a.typesArray=["Olives","Onions","Mushrooms"],a.subOrders=[];var e=new Firebase(c+"orders"),f=new Firebase(c),g=b(e),h=d(f);a.$on("$firebaseSimpleLogin:login",function(){a.username=h.user.displayName}),a.orders=g.$asArray(),a.addSubOrder=function(){a.subOrders.push({num:a.numSlices,type:a.sliceType})},a.deleteSubOrder=function(b){a.subOrders.splice(b,1)},a.shareOrder=function(){a.orders.$add({username:a.username})}}]),app.factory("Order",["$firebase","FIREBASE_URL",function(a,b){var c=new Firebase(b+"orders"),d=a(c),e={all:d.$asArray,create:function(a){return d.$add(a)},find:function(a){return d.$child(a)},"delete":function(a){return d.$remove(a)}};return e}]);